name: Clear production database

on:
  workflow_dispatch:
    inputs:
      password:
        description: 'Workflow password'
        type: string
        required: true

env:
  PASSWORD: ${{ inputs.password }}

jobs:
  clear-prod-db:
    runs-on: mn-rtu-gh-runner
    steps:
      - name: Check workflow password(true)
        if: $PASSWORD == ${{ secrets.DB_CLEAR_PASSWORD }}
        run: |
            docker volume rm app-db-data || true
            docker volume create app-db-data
      - name: Check workflow password(false)
        if: $PASSWORD != ${{ secrets.DB_CLEAR_PASSWORD }}
        run: |
            echo "Incorrect action password"
            